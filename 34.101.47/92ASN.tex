\begin{appendix}{Б}{рекомендуемое}{Модуль АСН.1}
\label{ASN}

\hiddensection{Идентификаторы}

Алгоритмам настоящего стандарта присваиваются следующие идентификаторы:
\begin{center}
\begin{tabular}{p{4cm}p{12cm}}
\texttt{hmac-hspec} & 
алгоритм выработки имитовставки в режиме HMAC (см.~\ref{HMAC})
с функций хэширования, определяемой долговременными параметрами;\\ 
%
\texttt{hmac-hbelt} & 
алгоритм выработки имитовставки в режиме HMAC (см.~\ref{HMAC})
с функцией хэширования СТБ~34.101.31;\\ 
%
\texttt{brng-ctr-hspec} & 
алгоритм генерации псевдослучайных чисел в режиме счетчика 
(см.~\ref{PRNG-CTR})
с функцией хэширования, определяемой долговременными параметрами;\\ 
%
\texttt{brng-ctr-hbelt} & 
алгоритм генерации псевдослучайных чисел в режиме счетчика 
(см.~\ref{PRNG-CTR})
с функцией хэширования СТБ~34.101.31;\\ 
%
\texttt{brng-ctr-stb11761} & 
алгоритм генерации псевдослучайных чисел в режиме счетчика 
(см.~\ref{PRNG-CTR})
с функцией хэширования СТБ~1176.1 и дополнительными уточнениями (см. далее);\\ 
%
\texttt{brng-hmac-hspec} & 
алгоритм генерации псевдослучайных чисел в режиме HMAC 
(см.~\ref{PRNG-HMAC})
с функцией хэширования, определяемой долговременными параметрами;\\ 
%
\texttt{brng-hmac-hbelt} & 
алгоритм генерации псевдослучайных чисел в режиме HMAC 
(см.~\ref{PRNG-HMAC})
с функцией хэширования СТБ~34.101.31;\\
%
\texttt{hotp-hspec} & 
алгоритм генерации одноразового пароля в режиме HOTP
(см.~\ref{OTP.HOTP}) с функцией хэширования, 
определяемой долговременными параметрами;\\ 
%
\texttt{hotp-hbelt} & 
алгоритм генерации одноразового пароля в режиме HOTP
(см.~\ref{OTP.HOTP}) с функцией хэширования СТБ~34.101.31;\\ 
%
\texttt{totp-hspec} & 
алгоритм генерации одноразового пароля в режиме TOTP
(см.~\ref{OTP.HOTP}) с функцией хэширования, 
определяемой долговременными параметрами;\\ 
%
\texttt{totp-hbelt} & 
алгоритм генерации одноразового пароля в режиме TOTP
(см.~\ref{OTP.HOTP}) с функцией хэширования СТБ~34.101.31;\\ 
%
\texttt{ocra-hspec} & 
алгоритм генерации одноразового пароля в режиме OCRA
(см.~\ref{OTP.OCRA}) с функцией хэширования, 
определяемой долговременными параметрами;\\ 
%
\texttt{ocra-hbelt} & 
алгоритм генерации одноразового пароля в режиме OCRA
(см.~\ref{OTP.OCRA}) с функцией хэширования СТБ~34.101.31.
\end{tabular}
\end{center}

Идентификатор алгоритма либо явно определяет используемую функцию хэширования~$h$,
либо указывает, что~$h$ задается ссылочно, через дополнительные параметры алгоритма.

Для задания~$h$ рекомендуется использовать 
тип~\texttt{AlgorithmIdentifier} АСН.1,
определенный в СТБ 34.101.19 следующим образом:
\begin{verbatim}
AlgorithmIdentifier ::= SEQUENCE {
  algorithm OBJECT IDENTIFIER,
  parameters ANY DEFINED BY algorithm	 
}
\end{verbatim}
%
Компонент \verb|algorithm| этого типа должен задавать идентификатор 
алгоритма хэширования, а компонент \verb|parameters|~--- 
параметры данного алгоритма. 

При использовании функции хэширования СТБ 1176.1:
\begin{itemize} 
\item[--]
компонент \texttt{algorithm} должен принимать значение 
\{1 2 112 0 2 0 1176 1 11\};
\item[--]
компонент \texttt{parameters} должен иметь тип \texttt{OCTET STRING}
и принимать значение~$\langle H\rangle_{256}$.
\end{itemize}
%
Здесь $H$~--- долговременный параметр алгоритма хэширования
(неотрицательное целое), 
описанный в п.~5.1 СТБ 1176.1. 
Долговременный параметр~$L$, также описанный в п.~5.1 СТБ 1176.1, 
должен равняться~$256$.

В алгоритме \texttt{brng-ctr-stb11761} используется алгоритм
хэширования СТБ 1176.1, в котором на шаге~15 
вместо проверки $d=n+2$ используется проверка $d=n+1$,
а параметр~$H$ задается так, что
$$
\langle H\rangle_{256}=
\texttt{4E4E9C9C\,9C9C4E4E\,9C9C4E4E\,4E4E9C9C\,9C9C4E4E\,4E4E9C9C\,4E4E9C9C\,9C9C4E4E}_{16}.
$$
При таких уточнениях алгоритм~\texttt{brng-ctr-stb11761}
соответствует алгоритму, определенному в~\cite{RD-PRNG}.

\hiddensection{Модуль АСН.1}

\begin{verbatim}
Brng-module-v2 {iso(1) member-body(2) by(112) 0 2 0 34 101 47 module(1) ver2(2)}
DEFINITIONS ::=
BEGIN
  brng OBJECT IDENTIFIER ::= {1 2 112 0 2 0 34 101 47}
  
  hmac-hspec OBJECT IDENTIFIER ::= {brng 11}
  hmac-hbelt OBJECT IDENTIFIER ::= {brng 12}
  brng-ctr-hspec OBJECT IDENTIFIER ::= {brng 21}
  brng-ctr-hbelt OBJECT IDENTIFIER ::= {brng 22}
  brng-ctr-stb11761 OBJECT IDENTIFIER ::= {brng 23}
  brng-hmac-hspec OBJECT IDENTIFIER ::= {brng 31}
  brng-hmac-hbelt OBJECT IDENTIFIER ::= {brng 32}

  hotp-hspec OBJECT IDENTIFIER ::= {brng 111}
  hotp-hbelt OBJECT IDENTIFIER ::= {brng 112}
  totp-hspec OBJECT IDENTIFIER ::= {brng 121}
  totp-hbelt OBJECT IDENTIFIER ::= {brng 122}
  ocra-hspec OBJECT IDENTIFIER ::= {brng 131}
  ocra-hbelt OBJECT IDENTIFIER ::= {brng 132}
END             
\end{verbatim}
\end{appendix}

